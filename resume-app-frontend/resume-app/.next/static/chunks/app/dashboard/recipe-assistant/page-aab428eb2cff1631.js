(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[295],{26069:function(e,t,a){Promise.resolve().then(a.t.bind(a,72972,23)),Promise.resolve().then(a.bind(a,69462)),Promise.resolve().then(a.bind(a,70488)),Promise.resolve().then(a.bind(a,61237)),Promise.resolve().then(a.bind(a,96246)),Promise.resolve().then(a.bind(a,32060))},61237:function(e,t,a){"use strict";a.d(t,{AgentPage:function(){return eu}});var r=a(57437),s=a(2265),n=a(99376),i=a(26298),l=a(12381),o=a(43643),c=a(93448);let d=s.forwardRef((e,t)=>{let{className:a,children:s,...n}=e;return(0,r.jsxs)(o.fC,{ref:t,className:(0,c.cn)("relative overflow-hidden",a),...n,children:[(0,r.jsx)(o.l_,{className:"h-full w-full rounded-[inherit]",children:s}),(0,r.jsx)(h,{}),(0,r.jsx)(o.Ns,{})]})});d.displayName=o.fC.displayName;let h=s.forwardRef((e,t)=>{let{className:a,orientation:s="vertical",...n}=e;return(0,r.jsx)(o.gb,{ref:t,orientation:s,className:(0,c.cn)("flex touch-none select-none transition-colors","vertical"===s&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===s&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",a),...n,children:(0,r.jsx)(o.q4,{className:"relative flex-1 rounded-full bg-border"})})});h.displayName=o.gb.displayName;var u=a(15868),x=a(74291),m=a(18930);let p=e=>{let{onDelete:t}=e;return(0,r.jsxs)(x.Vq,{children:[(0,r.jsx)(x.hg,{asChild:!0,children:(0,r.jsx)(l.z,{variant:"ghost",size:"icon",className:"flex-shrink-0 hover:bg-destructive transition-all duration-300 ease-in-out hover:text-white",children:(0,r.jsx)(m.Z,{className:"h-4 w-4"})})}),(0,r.jsxs)(x.cZ,{className:"sm:max-w-[425px]",children:[(0,r.jsxs)(x.fK,{children:[(0,r.jsx)(x.$N,{children:"Delete Conversation"}),(0,r.jsx)(x.Be,{children:"Are you sure you want to delete this conversation? This action cannot be undone."})]}),(0,r.jsxs)(x.cN,{children:[(0,r.jsx)(l.z,{variant:"outline",onClick:()=>{var e;return null===(e=document.getElementById("close-delete-dialog"))||void 0===e?void 0:e.click()},children:"Cancel"}),(0,r.jsx)(l.z,{variant:"destructive",onClick:()=>{var e;t(),null===(e=document.getElementById("close-delete-dialog"))||void 0===e||e.click()},children:"Delete"})]})]})]})};var g=a(48614);let f=e=>{let t=new Date,a=new Date(t);a.setDate(a.getDate()-1);let r=new Date(t);return r.setDate(r.getDate()-7),e.reduce((e,s)=>{let n=new Date(s.createdAt);return n.toDateString()===t.toDateString()?e.today.push(s):n.toDateString()===a.toDateString()?e.yesterday.push(s):n>r?e.lastWeek.push(s):e.older.push(s),e},{today:[],yesterday:[],lastWeek:[],older:[]})},y=e=>{let{title:t,conversations:a,onSelectConversation:s,onDeleteConversation:n,selectedConversation:o}=e;return(0,r.jsxs)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"mb-4",children:[(0,r.jsx)("h4",{className:"text-sm font-semibold text-muted-foreground mb-2",children:t}),(0,r.jsx)("div",{className:"space-y-2",children:a.map((e,t)=>(0,r.jsxs)(i.E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{duration:.2,delay:.05*t},className:"flex items-center space-x-2",children:[(0,r.jsx)(l.z,{variant:(null==o?void 0:o.id)===e.id?"secondary":"ghost",className:"flex-grow justify-start truncate",onClick:()=>s(e.id),children:(0,r.jsx)("span",{className:"truncate",children:e.title})}),(0,r.jsx)(p,{onDelete:()=>n(e.id)})]},e.id))})]})},v=e=>{let{isOpen:t,conversations:a,onSelectConversation:s,onNewConversation:n,onDeleteConversation:o,selectedConversation:c}=e,h=f(a);return(0,r.jsx)("div",{className:"fixed top-16 left-0 h-[calc(100vh-4rem)] bg-background border-r rounded-sm transition-all duration-300 ease-in-out ".concat(t?"w-80":"w-0 -translate-x-full"),children:(0,r.jsx)(g.M,{children:t&&(0,r.jsx)(i.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:"h-full",children:(0,r.jsxs)(d,{className:"flex-grow h-full w-full p-4",children:[(0,r.jsxs)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-bold text-primary",children:"Conversations"}),(0,r.jsx)(l.z,{variant:"ghost",size:"icon",onClick:n,className:"hover:bg-secondary hover:text-primary",children:(0,r.jsx)(u.Z,{className:"h-5 w-5"})})]}),(0,r.jsxs)(g.M,{children:[h.today.length>0&&(0,r.jsx)(y,{title:"Today",conversations:h.today,onSelectConversation:s,onDeleteConversation:o,selectedConversation:c},"today"),h.yesterday.length>0&&(0,r.jsx)(y,{title:"Yesterday",conversations:h.yesterday,onSelectConversation:s,onDeleteConversation:o,selectedConversation:c},"yesterday"),h.lastWeek.length>0&&(0,r.jsx)(y,{title:"Last Week",conversations:h.lastWeek,onSelectConversation:s,onDeleteConversation:o,selectedConversation:c},"lastWeek"),h.older.length>0&&(0,r.jsx)(y,{title:"Older",conversations:h.older,onSelectConversation:s,onDeleteConversation:o,selectedConversation:c},"older")]})]})})})})};var j=a(1399),b=a(66989);let w=e=>{let{title:t,className:a=""}=e,[n,l]=(0,s.useState)(""),[o,c]=(0,s.useState)(!0);return(0,s.useEffect)(()=>{c(!0),l("");let e="",a=setInterval(()=>{e.length<t.length?l(e=t.slice(0,e.length+1)):(clearInterval(a),c(!1))},50);return()=>clearInterval(a)},[t]),(0,r.jsxs)(i.E.h2,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"".concat(a," flex items-center"),children:[n,o&&(0,r.jsx)(i.E.span,{initial:{opacity:0},animate:{opacity:1},transition:{repeat:1/0,duration:.5},className:"inline-block ml-1 w-[2px] h-[1em] bg-current"})]})};var N=e=>{let{isSidebarOpen:t,handleToggleSidebar:a,selectedConversation:s,isInitialLoading:n}=e;return(0,r.jsx)("div",{className:"flex items-center justify-between space-y-2",children:n?(0,r.jsx)("div",{className:"h-9 w-[600px] bg-gray-200 dark:bg-muted rounded animate-pulse"}):(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)(l.z,{variant:"ghost",size:"icon",onClick:a,className:"p-2 text-primary",children:[t?(0,r.jsx)(j.Z,{className:"h-6 w-6"}):(0,r.jsx)(b.Z,{className:"h-6 w-6"}),(0,r.jsx)("span",{className:"sr-only",children:t?"Close sidebar":"Open sidebar"})]}),s&&(0,r.jsx)(w,{title:s.title||"Untitled Conversation",className:"text-3xl font-bold tracking-tight"})]})})},k=a(79820),C=a(52731),S=a(34709),E=a(22135),D=a(40875),I=a(31810),_=a(37157),z=a(30401),T=a(78867),Z=a(76980),O=a(20265),R=a(71488),P=a(21156),A=a(56940),F=a(97059),U=a(62994),K=a(8147),M=a(22190),L=a(54061),W=a(77031),J=a(83046),B=a(47625),H=a(31004);let Y=["hsl(var(--chart-1))","hsl(var(--chart-2))","hsl(var(--chart-3))","hsl(var(--chart-4))","hsl(var(--chart-5))"],q=e=>e.toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"2-digit"}),G=e=>{if(e instanceof Date)return e;if("string"==typeof e||"number"==typeof e)return new Date(e);throw Error("Invalid date value")};var V=e=>{let{chartData:t}=e;if(!t||!t.data||!Array.isArray(t.data)||0===t.data.length)return console.error("Invalid or empty chart data"),(0,r.jsx)("div",{children:"Error: Invalid or empty chart data"});let{data:a,x_column:s,y_column:n,y_columns:l,chart_type:o,title:c,description:d,footer:h}=t;if(!s||!n&&(!l||0===l.length))return console.error("Missing x_column or y_column(s)"),(0,r.jsx)("div",{children:"Error: Missing chart configuration"});let u=l||(n?[n]:[]),x=a.map(e=>{let t={};return Object.keys(e).forEach(a=>{a===s?t[a]=G(e[a]):u.includes(a)&&(t[a]="number"==typeof e[a]?e[a]:parseFloat(e[a])||0)}),t});x.sort((e,t)=>e[s].getTime()-t[s].getTime());let m=q(x[0][s]),p=q(x[x.length-1][s]),g=u.reduce((e,t,a)=>({...e,[t]:{label:t,color:Y[a%Y.length]}}),{}),f=e=>{let{active:t,payload:a,label:s}=e;return t&&a&&a.length?(0,r.jsxs)("div",{className:"bg-background p-2 border border-border rounded shadow-md",children:[(0,r.jsx)("p",{className:"text-sm font-semibold",children:q(new Date(s))}),a.map((e,t)=>{var a;return(0,r.jsx)("p",{style:{color:e.color},className:"text-sm",children:"".concat(e.name,": ").concat(null===(a=e.value)||void 0===a?void 0:a.toFixed(2))},t)})]}):null},y="line"===o?(0,r.jsxs)(P.w,{data:x,children:[(0,r.jsx)(A.q,{strokeDasharray:"3 3"}),(0,r.jsx)(F.K,{dataKey:s,tickFormatter:e=>q(new Date(e))}),(0,r.jsx)(U.B,{}),(0,r.jsx)(K.u,{content:(0,r.jsx)(f,{})}),(0,r.jsx)(M.D,{}),u.map((e,t)=>(0,r.jsx)(L.x,{type:"monotone",dataKey:e,stroke:Y[t%Y.length],activeDot:{r:8}},e))]}):(0,r.jsxs)(W.v,{data:x,children:[(0,r.jsx)(A.q,{strokeDasharray:"3 3"}),(0,r.jsx)(F.K,{dataKey:s,tickFormatter:e=>q(new Date(e))}),(0,r.jsx)(U.B,{}),(0,r.jsx)(K.u,{content:(0,r.jsx)(f,{})}),(0,r.jsx)(M.D,{}),u.map((e,t)=>(0,r.jsx)(J.$,{dataKey:e,fill:Y[t%Y.length],radius:8},e))]});return(0,r.jsx)(i.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.5},children:(0,r.jsxs)(k.Zb,{children:[(0,r.jsxs)(k.Ol,{children:[(0,r.jsx)(k.ll,{children:c||"Data Visualization"}),(0,r.jsx)(k.SZ,{children:d||"".concat(m," - ").concat(p)})]}),(0,r.jsx)(k.aY,{children:(0,r.jsx)(H.BO,{config:g,className:"min-h-[200px] h-[800px] w-full",children:(0,r.jsx)(B.h,{width:"100%",height:"100%",children:y})})}),(0,r.jsx)(k.eW,{className:"flex-col items-start gap-2 text-sm",children:(0,r.jsx)("div",{className:"leading-none text-muted-foreground",children:h||""})})]})})};let $=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("textarea",{className:(0,c.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",a),ref:t,...s})});function Q(e){if(!(e&&"object"==typeof e&&Array.isArray(e.data)&&"string"==typeof e.x_column&&("line"===e.chart_type||"bar"===e.chart_type)&&("string"==typeof e.y_column||Array.isArray(e.y_columns))&&(!e.y_columns||e.y_columns.every(e=>"string"==typeof e))&&(void 0===e.title||"string"==typeof e.title)&&(void 0===e.description||"string"==typeof e.description)&&(void 0===e.footer||"string"==typeof e.footer)))throw Error("Invalid chart data received from API");return e}$.displayName="Textarea";let X=[" "];function ee(e){let{conversation:t,onUpdateConversationTitle:a}=e,[n,o]=(0,s.useState)([]),[c,d]=(0,s.useState)(""),[h,u]=(0,s.useState)(!1),[x,m]=(0,s.useState)(""),p=(0,s.useRef)(null),[f,y]=(0,s.useState)({}),[v,j]=(0,s.useState)({}),b=(0,s.useRef)(null),[w,N]=(0,s.useState)(""),P=(0,s.useRef)(null),A=(0,s.useCallback)((e,t)=>{navigator.clipboard.writeText(e).then(()=>{j(e=>({...e,[t]:!0})),setTimeout(()=>{j(e=>({...e,[t]:!1}))},2e3)})},[]),F=(0,s.useCallback)(()=>{setTimeout(()=>{var e;null===(e=p.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},0)},[]);(0,s.useEffect)(()=>{F()},[n,h,F]),(0,s.useEffect)(()=>{""!==w&&P.current&&(o(e=>e.map(e=>e.id===P.current?{...e,text:w}:e)),F())},[w,F]);let U=(0,s.useCallback)(async()=>{if(t)try{let e=await fetch("/api/message?conversationId=".concat(t.id));if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let a=await e.json(),r=[];a.forEach(e=>{if("user"===e.role)r.push({id:e.id,text:e.content,isUser:!0,isTyping:!1,type:"text"});else if(e.content&&r.push({id:e.id+"_text",text:e.content,isUser:!1,isTyping:!1,reasoning:e.reasoning,type:"text"}),e.chart)try{let t=Q(e.chart);r.push({id:e.id+"_chart",isUser:!1,chart:t,type:"chart"})}catch(e){console.error("Invalid chart data received:",e)}}),o(r)}catch(e){console.error("Error fetching messages:",e)}},[t]);(0,s.useEffect)(()=>{t?U():o([])},[t,U]);let K=()=>{let e=Math.floor(Math.random()*X.length);return X[e]},M=async()=>{if(""===c.trim()||!t)return;let e=0===n.filter(e=>e.isUser).length,a={id:Date.now().toString(),text:c,isUser:!0,type:"text"};d(""),b.current&&(b.current.style.height="auto"),u(!0),m(K()),o(e=>[...e,a]);try{let r=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:a.text,conversationId:t.id})});if(!r.ok)throw Error("Failed to get response from chat API");let s=await r.json();u(!1);let n=Date.now().toString();P.current=n,o(e=>[...e,{id:n,text:"",isUser:!1,isTyping:!0,reasoning:s.reasoning,type:"text"}]);let i="",l=setInterval(()=>{if(i.length<s.reply.length){let e=Math.min(20,s.reply.length-i.length);i=s.reply.slice(0,i.length+e),N(i)}else if(clearInterval(l),N(""),o(e=>e.map(e=>e.id===n?{...e,isTyping:!1,text:s.reply}:e)),e&&a.text&&L(a.text),s.chart)try{let e=Q(s.chart),t=(Date.now()+1).toString();o(a=>[...a,{id:t,isUser:!1,chart:e,type:"chart"}])}catch(e){console.error("Invalid chart data received:",e)}},5)}catch(t){console.error("Error getting AI response:",t),u(!1);let e={id:Date.now().toString(),text:"Sorry, I encountered an error. Please try again.",isUser:!1,type:"text"};o(t=>[...t,e])}},L=(0,s.useCallback)(async e=>{if(t)try{let r=await fetch("/api/generate-title",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({conversationId:t.id,message:e})});if(!r.ok)throw Error("Failed to generate title");let{title:s}=await r.json();s&&s!==t.title&&await a(t.id,s)}catch(e){console.error("Error generating title:",e)}},[t,a]),W=()=>{b.current&&(b.current.style.height="auto",b.current.style.height="".concat(b.current.scrollHeight,"px"))},J=(0,s.useCallback)(e=>{y(t=>({...t,[e]:!t[e]}))},[]);return(0,r.jsxs)(k.Zb,{className:"w-full bg-secondary",children:[(0,r.jsx)(k.aY,{children:(0,r.jsxs)("div",{className:"h-[75vh] lg:h-[84vh] xl:[86vh] overflow-y-auto p-4 space-y-4",children:[(0,r.jsx)(g.M,{children:n.map(e=>(0,r.jsx)(i.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"flex ".concat(e.isUser?"justify-end":"justify-start"),children:e.isUser?(0,r.jsx)("div",{className:"p-4 mt-4 rounded-lg max-w-[80%] break-words bg-primary text-primary-foreground",children:e.text}):(0,r.jsx)("div",{className:"flex flex-col items-start max-w-[80%] w-full",children:(0,r.jsxs)("div",{className:"p-4 px-6 mt-4 rounded-lg bg-background text-secondary-foreground overflow-hidden w-full",children:["text"===e.type&&(0,r.jsxs)(i.E.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[(0,r.jsx)(C.D,{remarkPlugins:[S.Z],className:"prose dark:prose-invert max-w-none overflow-x-auto",components:{table:e=>(0,r.jsx)("div",{className:"overflow-x-auto my-8",children:(0,r.jsx)("table",{className:"min-w-full divide-y divide-gray-200 bg-background",...e})}),th:e=>(0,r.jsx)("th",{className:"px-6 py-3 bg-gray-50 dark:bg-gray-800 text-left text-xs font-medium text-gray-500 dark:text-white uppercase tracking-wider",...e}),td:e=>(0,r.jsx)("td",{className:"px-6 py-4 dark:bg-gray-900 whitespace-nowrap text-sm text-gray-500 dark:text-white",...e}),code:e=>(0,r.jsx)("code",{...e,className:"break-all whitespace-pre-wrap"}),pre:e=>(0,r.jsx)("pre",{...e,className:"overflow-x-auto"})},children:e.isTyping?w:e.text||""}),e.isTyping&&(0,r.jsx)("span",{className:"inline-block ml-1 animate-pulse",children:"â–‹"}),(0,r.jsx)("div",{className:"mt-4 pt-2 border-t border-border",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[e.reasoning&&(0,r.jsxs)(l.z,{onClick:()=>J(e.id),variant:"ghost",size:"sm",className:"text-muted-foreground hover:text-foreground",children:[f[e.id]?"Hide":"Show"," ","Reasoning",f[e.id]?(0,r.jsx)(E.Z,{size:16,className:"ml-2"}):(0,r.jsx)(D.Z,{size:16,className:"ml-2"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)(R.pn,{children:(0,r.jsxs)(R.u,{children:[(0,r.jsx)(R.aJ,{asChild:!0,children:(0,r.jsx)(l.z,{variant:"ghost",size:"sm",className:"text-muted-foreground hover:text-foreground",children:(0,r.jsx)(I.Z,{size:16})})}),(0,r.jsx)(R._v,{children:(0,r.jsx)("p",{children:"Rate response positively"})})]})}),(0,r.jsx)(R.pn,{children:(0,r.jsxs)(R.u,{children:[(0,r.jsx)(R.aJ,{asChild:!0,children:(0,r.jsx)(l.z,{variant:"ghost",size:"sm",className:"text-muted-foreground hover:text-foreground",children:(0,r.jsx)(_.Z,{size:16})})}),(0,r.jsx)(R._v,{children:(0,r.jsx)("p",{children:"Rate response negatively"})})]})}),(0,r.jsx)(R.pn,{children:(0,r.jsxs)(R.u,{children:[(0,r.jsx)(R.aJ,{asChild:!0,children:(0,r.jsx)(l.z,{onClick:()=>A(e.text,e.id),variant:"ghost",size:"sm",className:"text-muted-foreground hover:text-foreground",children:v[e.id]?(0,r.jsx)(z.Z,{size:16,className:"text-green-500"}):(0,r.jsx)(T.Z,{size:16})})}),(0,r.jsx)(R._v,{children:(0,r.jsx)("p",{children:v[e.id]?"Copied!":"Copy response"})})]})})]})]})}),f[e.id]&&e.reasoning&&(0,r.jsx)(g.M,{children:(0,r.jsx)(i.E.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},className:"overflow-hidden",children:(0,r.jsx)("div",{className:"mt-2 p-2 bg-muted rounded-md overflow-x-auto",children:(0,r.jsx)("div",{className:"min-w-[400px]",children:(0,r.jsx)(C.D,{remarkPlugins:[S.Z],className:"prose dark:prose-invert text-sm",components:{table:e=>(0,r.jsx)("div",{className:"overflow-x-auto my-8",children:(0,r.jsx)("table",{className:"min-w-full divide-y divide-gray-200 bg-background",...e})}),th:e=>(0,r.jsx)("th",{className:"px-6 py-3 bg-gray-50 dark:bg-gray-800 text-left text-xs font-medium text-gray-500 dark:text-white uppercase tracking-wider",...e}),td:e=>(0,r.jsx)("td",{className:"px-6 py-4 dark:bg-gray-900 whitespace-nowrap text-sm text-gray-500 dark:text-white",...e}),code:e=>(0,r.jsx)("code",{...e,className:"break-all whitespace-pre-wrap"}),pre:e=>(0,r.jsx)("pre",{...e,className:"overflow-x-auto"})},children:e.reasoning})})})})})]}),"chart"===e.type&&e.chart&&(0,r.jsx)("div",{className:"p-4 w-full shadow-sm",children:(0,r.jsx)(V,{chartData:e.chart})})]})})},e.id))}),h&&(0,r.jsx)(i.E.div,{initial:{opacity:0},animate:{opacity:1},className:"flex justify-start",children:(0,r.jsx)("div",{className:"bg-background text-secondary-foreground p-4 rounded-lg animate-pulse",children:x})}),(0,r.jsx)("div",{ref:p})]})}),(0,r.jsx)(k.eW,{children:(0,r.jsxs)("div",{className:"flex w-full space-x-2",children:[(0,r.jsx)(l.z,{variant:"ghost",size:"icon",className:"hover:text-primary hover:bg-background",children:(0,r.jsx)(Z.Z,{size:18})}),(0,r.jsx)($,{ref:b,value:c,onChange:e=>{d(e.target.value),W()},onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),M())},placeholder:"Type your message... (Shift+Enter for new line)",className:"flex-1 min-h-[40px] max-h-[200px] bg-white resize-none",disabled:!t,rows:1}),(0,r.jsx)(l.z,{onClick:M,variant:"outline",className:"items-center justify-center text-primary hover:text-white hover:bg-primary",disabled:!t,children:(0,r.jsx)(O.Z,{size:18})})]})})]})}var et=a(73247),ea=a(38553),er=a(5136),es=a(16657),en=a(6830),ei=a(91723),el=a(99397);let eo=e=>{let{icon:t,title:a,description:s}=e;return(0,r.jsxs)(i.E.div,{className:"bg-card text-card-foreground rounded-lg p-6 shadow-md hover:shadow-lg transition-shadow duration-300 dark:ring-1 ring-primary",whileHover:{y:-5},children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[t,(0,r.jsx)("h3",{className:"text-lg font-semibold",children:a})]}),(0,r.jsx)("p",{className:"mt-2 text-sm text-muted-foreground",children:s})]})};var ec=e=>{let{onNewConversation:t}=e;return(0,r.jsxs)(i.E.div,{className:"w-full min-h-[calc(100vh-200px)] flex flex-col items-center justify-center px-4 py-8",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[(0,r.jsxs)("div",{className:"text-center space-y-6 max-w-3xl mx-auto",children:[(0,r.jsx)(i.E.h2,{className:"text-3xl font-bold text-primary",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.5},children:"Welcome to Your Smart Recipe Assistant"}),(0,r.jsx)(i.E.p,{className:"text-lg text-muted-foreground",initial:{opacity:0},animate:{opacity:1},transition:{delay:.4,duration:.5},children:"Your personal cooking companion: Get recipe recommendations, meal planning help, and nutritional guidance all in one place."})]}),(0,r.jsxs)(i.E.div,{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mt-12 max-w-6xl mx-auto",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6,duration:.5},children:[(0,r.jsx)(eo,{icon:(0,r.jsx)(et.Z,{className:"h-8 w-8 text-primary"}),title:"Recipe Discovery",description:"Find recipes based on your available ingredients and preferences."}),(0,r.jsx)(eo,{icon:(0,r.jsx)(ea.Z,{className:"h-8 w-8 text-primary"}),title:"Cooking Guidance",description:"Get step-by-step cooking instructions and helpful tips."}),(0,r.jsx)(eo,{icon:(0,r.jsx)(er.Z,{className:"h-8 w-8 text-primary"}),title:"Meal Planning",description:"Create balanced weekly meal plans tailored to your needs."}),(0,r.jsx)(eo,{icon:(0,r.jsx)(es.Z,{className:"h-8 w-8 text-primary"}),title:"Nutritional Analysis",description:"Track nutritional content and maintain a balanced diet."}),(0,r.jsx)(eo,{icon:(0,r.jsx)(en.Z,{className:"h-8 w-8 text-primary"}),title:"Portion Calculator",description:"Easily adjust serving sizes and ingredient quantities."}),(0,r.jsx)(eo,{icon:(0,r.jsx)(ei.Z,{className:"h-8 w-8 text-primary"}),title:"Time Management",description:"Get cooking time estimates and meal prep schedules."})]}),(0,r.jsx)("div",{className:"mt-12",children:(0,r.jsxs)(l.z,{onClick:t,className:"bg-primary text-white hover:bg-muted transition-all duration-150 ease-in-out",size:"lg",children:[(0,r.jsx)(el.Z,{className:"mr-2 h-5 w-5"}),"Start Recipe Chat"]})})]})},ed=e=>{let{isInitialLoading:t,conversations:a,selectedConversation:s,updateConversationTitle:n,handleNewConversation:i}=e;return t?(0,r.jsx)("div",{className:"w-full h-[calc(100vh-200px)] flex items-center justify-center",children:(0,r.jsx)("div",{className:"animate-pulse text-lg text-muted-foreground",children:"Loading..."})}):0===a.length?(0,r.jsx)(ec,{onNewConversation:i}):(0,r.jsx)(ee,{conversation:s,onUpdateConversationTitle:n})};let eh=()=>{let[e,t]=(0,s.useState)([]);return(0,s.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/conversation");if(!e.ok)throw Error("Failed to fetch conversations");let a=await e.json();t(a.map(e=>({...e,createdAt:new Date(e.createdAt)})))}catch(e){console.error("Error fetching conversations:",e)}})()},[]),[e,t]};function eu(){let e=(0,n.useRouter)(),t=(0,n.useSearchParams)(),[a,l]=(0,s.useState)(()=>{{let e=localStorage.getItem("isSidebarOpen");return null===e||JSON.parse(e)}}),[o,c]=(0,s.useState)(!0),[d,h]=(0,s.useState)(null),[u,x]=(0,s.useState)(null),[m,p]=eh(),g=(0,s.useCallback)(t=>{let a=new URLSearchParams;t&&a.set("conversationId",t),e.push("/dashboard/recipe-assistant?".concat(a.toString()),{scroll:!1})},[e]);(0,s.useEffect)(()=>{localStorage.setItem("isSidebarOpen",JSON.stringify(a))},[a]),(0,s.useEffect)(()=>{void 0!==m&&c(!1)},[m]),(0,s.useEffect)(()=>{if(!o&&null===d){let e=t.get("conversationId"),a=localStorage.getItem("lastSelectedConversationId"),r=e||a||(m.length>0?m[0].id:null);r&&!m.some(e=>e.id===r)&&(r=m.length>0?m[0].id:null),r?(h(r),localStorage.setItem("lastSelectedConversationId",r)):(h(null),localStorage.removeItem("lastSelectedConversationId")),g(r)}},[o,m,d,t,g]),(0,s.useEffect)(()=>{d&&m.length>0?x(m.find(e=>e.id===d)||null):x(null)},[d,m]);let f=(0,s.useCallback)(async()=>{try{let e=await fetch("/api/conversation",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:"Recipe Chat ".concat(m.length+1)})});if(!e.ok)throw Error("Failed to create new conversation");let t=await e.json();p(e=>[t,...e]),h(t.id),localStorage.setItem("lastSelectedConversationId",t.id),g(t.id)}catch(e){console.error("Error creating new conversation:",e)}},[m.length,p,g]),y=async(e,t)=>{try{let a=await fetch("/api/conversation/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:t})});if(!a.ok)throw Error("Failed to update conversation title");let r=await a.json();p(e=>e.map(e=>e.id===r.id?r:e)),x(r)}catch(e){console.error("Error updating conversation title:",e)}},j=async e=>{try{let t=await fetch("/api/conversation/".concat(e),{method:"DELETE"});if(!t.ok){let e=await t.json();throw Error(e.error||"Failed to delete conversation")}p(t=>t.filter(t=>t.id!==e)),d===e&&(localStorage.removeItem("lastSelectedConversationId"),h(null),x(null),g(null))}catch(e){console.error("Error deleting conversation:",e),alert("Failed to delete conversation. Please try again.")}};return(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)(v,{isOpen:a,conversations:m,onSelectConversation:e=>{h(e),localStorage.setItem("lastSelectedConversationId",e),g(e)},onNewConversation:f,onDeleteConversation:j,selectedConversation:u}),(0,r.jsx)(i.E.div,{className:"flex-1",initial:!1,animate:{marginLeft:a?"20rem":0},transition:{type:"spring",stiffness:300,damping:30},children:(0,r.jsx)("div",{className:"flex-col md:flex",children:(0,r.jsxs)("div",{className:"flex-1 space-y-4 p-8 pt-4",children:[(0,r.jsx)(N,{isSidebarOpen:a,handleToggleSidebar:()=>l(!a),selectedConversation:u,isInitialLoading:o}),(0,r.jsx)("div",{className:"flex pt-1 space-x-2",children:(0,r.jsx)(ed,{isInitialLoading:o,conversations:m,selectedConversation:u,updateConversationTitle:y,handleNewConversation:f})})]})})})]})}},79820:function(e,t,a){"use strict";a.d(t,{Ol:function(){return l},SZ:function(){return c},Zb:function(){return i},aY:function(){return d},eW:function(){return h},ll:function(){return o}});var r=a(57437),s=a(2265),n=a(93448);let i=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...s})});i.displayName="Card";let l=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",a),...s})});l.displayName="CardHeader";let o=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("h3",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",a),...s})});o.displayName="CardTitle";let c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",a),...s})});c.displayName="CardDescription";let d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",a),...s})});d.displayName="CardContent";let h=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",a),...s})});h.displayName="CardFooter"},31004:function(e,t,a){"use strict";a.d(t,{BO:function(){return u},dg:function(){return p},h7:function(){return m}});var r=a(57437),s=a(2265),n=a(47625),i=a(8147),l=a(22190),o=a(93448);let c={light:"",dark:".dark"},d=s.createContext(null);function h(){let e=s.useContext(d);if(!e)throw Error("useChart must be used within a <ChartContainer />");return e}let u=s.forwardRef((e,t)=>{let{id:a,className:i,children:l,config:c,...h}=e,u=s.useId(),m="chart-".concat(a||u.replace(/:/g,""));return(0,r.jsx)(d.Provider,{value:{config:c},children:(0,r.jsxs)("div",{"data-chart":m,ref:t,className:(0,o.cn)("flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line-line]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none",i),...h,children:[(0,r.jsx)(x,{id:m,config:c}),(0,r.jsx)(n.h,{children:l})]})})});u.displayName="Chart";let x=e=>{let{id:t,config:a}=e,s=Object.entries(a).filter(e=>{let[,t]=e;return t.theme||t.color});return s.length?(0,r.jsx)("style",{dangerouslySetInnerHTML:{__html:Object.entries(c).map(e=>{let[a,r]=e;return"\n".concat(r," [data-chart=").concat(t,"] {\n").concat(s.map(e=>{var t;let[r,s]=e,n=(null===(t=s.theme)||void 0===t?void 0:t[a])||s.color;return n?"  --color-".concat(r,": ").concat(n,";"):null}).join("\n"),"\n}\n")})}}):null},m=i.u,p=s.forwardRef((e,t)=>{let{active:a,payload:n,className:i,indicator:l="dot",hideLabel:c=!1,hideIndicator:d=!1,label:u,labelFormatter:x,labelClassName:m,formatter:p,color:f,nameKey:y,labelKey:v}=e,{config:j}=h(),b=s.useMemo(()=>{var e;if(c||!(null==n?void 0:n.length))return null;let[t]=n,a="".concat(v||t.dataKey||t.name||"value"),s=g(j,t,a),i=v||"string"!=typeof u?null==s?void 0:s.label:(null===(e=j[u])||void 0===e?void 0:e.label)||u;return x?(0,r.jsx)("div",{className:(0,o.cn)("font-medium",m),children:x(i,n)}):i?(0,r.jsx)("div",{className:(0,o.cn)("font-medium",m),children:i}):null},[u,x,n,c,m,j,v]);if(!a||!(null==n?void 0:n.length))return null;let w=1===n.length&&"dot"!==l;return(0,r.jsxs)("div",{ref:t,className:(0,o.cn)("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",i),children:[w?null:b,(0,r.jsx)("div",{className:"grid gap-1.5",children:n.map((e,t)=>{let a="".concat(y||e.name||e.dataKey||"value"),s=g(j,e,a),n=f||e.payload.fill||e.color;return(0,r.jsx)("div",{className:(0,o.cn)("flex w-full items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground","dot"===l&&"items-center"),children:p&&(null==e?void 0:e.value)!==void 0&&e.name?p(e.value,e.name,e,t,e.payload):(0,r.jsxs)(r.Fragment,{children:[(null==s?void 0:s.icon)?(0,r.jsx)(s.icon,{}):!d&&(0,r.jsx)("div",{className:(0,o.cn)("shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",{"h-2.5 w-2.5":"dot"===l,"w-1":"line"===l,"w-0 border-[1.5px] border-dashed bg-transparent":"dashed"===l,"my-0.5":w&&"dashed"===l}),style:{"--color-bg":n,"--color-border":n}}),(0,r.jsxs)("div",{className:(0,o.cn)("flex flex-1 justify-between leading-none",w?"items-end":"items-center"),children:[(0,r.jsxs)("div",{className:"grid gap-1.5",children:[w?b:null,(0,r.jsx)("span",{className:"text-muted-foreground",children:(null==s?void 0:s.label)||e.name})]}),e.value&&(0,r.jsx)("span",{className:"font-mono font-medium tabular-nums text-foreground",children:e.value.toLocaleString()})]})]})},e.dataKey)})})]})});function g(e,t,a){if("object"!=typeof t||null===t)return;let r="payload"in t&&"object"==typeof t.payload&&null!==t.payload?t.payload:void 0,s=a;return a in t&&"string"==typeof t[a]?s=t[a]:r&&a in r&&"string"==typeof r[a]&&(s=r[a]),s in e?e[s]:e[a]}p.displayName="ChartTooltip",l.D,s.forwardRef((e,t)=>{let{className:a,hideIcon:s=!1,payload:n,verticalAlign:i="bottom",nameKey:l}=e,{config:c}=h();return(null==n?void 0:n.length)?(0,r.jsx)("div",{ref:t,className:(0,o.cn)("flex items-center justify-center gap-4","top"===i?"pb-3":"pt-3",a),children:n.map(e=>{let t="".concat(l||e.dataKey||"value"),a=g(c,e,t);return(0,r.jsxs)("div",{className:(0,o.cn)("flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"),children:[(null==a?void 0:a.icon)&&!s?(0,r.jsx)(a.icon,{}):(0,r.jsx)("div",{className:"h-2 w-2 shrink-0 rounded-[2px]",style:{backgroundColor:e.color}}),null==a?void 0:a.label]},e.value)})}):null}).displayName="ChartLegend"}},function(e){e.O(0,[130,193,27,465,605,878,649,298,253,141,539,971,117,744],function(){return e(e.s=26069)}),_N_E=e.O()}]);